<!DOCTYPE html>
<#assign ctx=request.contextPath>
<html>
<head>
    <title>后台管理系统</title>
	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="${ctx}/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="${ctx}/css/bootstrap-responsive.css" />
    <link rel="stylesheet" type="text/css" href="${ctx}/css/style.css" />
    <link rel="stylesheet" type="text/css" href="${ctx}/css/adminLogin.css" />
    <script type="text/javascript" src="${ctx}/js/jquery.js"></script>
    <script type="text/javascript" src="${ctx}/js/bootstrap.js"></script>
	<script type="text/javascript">
		$(function(){
			$("#vimg").mouseover(function(){
				$(this).css("cursor","pointer");
			}).click(function(){
				$("#vimg").attr("src", "${ctx}/verify?random=" + Math.random());
			});
			
			/** 为表单绑定onsubmit提交事件 */
			$("#loginBtn").click(function(){
				
				/** 做表单输入校验 */
				var userId = $("#userId");
				var pwd = $("#pwd");
				var code = $("#code");
				var isSubmit = true;
				/** 隐藏所有的提示信息 */
				$("strong[id$='_tip']").hide(); /* 要放到该函数里面，否则当验证正确时不会重新隐藏 */
				if ($.trim(userId.val()) == ""){
					var isSubmit = false;
					$("#userId_tip").html("* 用户名不能空！").show();
					userId.focus();// 调用文本框获取焦点方法
				}else if (!/^\w{5,20}$/.test($.trim(userId.val()))){
					var isSubmit = false;
					$("#userId_tip").html("* 账号格式不正确").show();
					userId.focus();// 调用文本框获取焦点方法
				}else if ($.trim(pwd.val()) == ""){
					var isSubmit = false;
					$("#pwd_tip").html("* 设置密码不能空！").show();
					pwd.focus();// 调用文本框获取焦点方法
				}else if (!/^\w{6,20}$/.test($.trim(pwd.val()))){
					var isSubmit = false;
					$("#pwd_tip").html("* 设置密码必须在6-20位之间！").show();
					pwd.focus();// 调用文本框获取焦点方法
				}else if ($.trim(code.val()) == ""){
					var isSubmit = false;
					$("#code_tip").html("* 验证码不能为空！").show();
					code.focus();// 调用文本框获取焦点方法
				}else if (!/^[a-zA-Z0-9]{4}$/.test($.trim(code.val()))){
					var isSubmit = false;
					tip = "验证码格式不正确！";
					code.focus();// 调用文本框获取焦点方法
				} 
				/** 判断表单是否通过校验 */
				if (isSubmit){
					var params = $("form[class=form-signin]").serialize();
					var url = "${ctx}/admin/adminLoginAjax";
					$.post(url,params,function(data){
						if(data.status == 0){
								window.location = "${ctx}/admin/main"
							}else{
								alert(data.tip);
								//刷新验证码
								$("#vimg").trigger("click");
							}
					},"json");
				} 
			});
			//绑定回车键事件，当用户按了回车键，就提交表单
			$(document).keydown(function(event){
				//全等于13代表了了回车键
				if(event.keyCode === 13){
					$("#loginBtn").trigger("click");
				}
			});
			
			//实现跳出框架界面的js代码
			//用于解决当跳转页面没有占据整个页面时的判断
			if(top.location !=self.location){
				
				top.location = self.location;
			}
			
			
			
		});
		
	
	</script>
	 
</head>
<body>
<div class="container">

    <form class="form-signin">
        <h2 class="form-signin-heading"><center>登录系统</center></h2>
        <input type="text" name="userId" id="userId" value="" class="input-block-level" placeholder="账号">
        <font>
			<strong  id="userId_tip" class="normal">* 用户名不能为空！</strong>
		</font>
        <input type="password" name="password" value="" id="pwd" class="input-block-level" placeholder="密码">
        <font>
			<strong  id="pwd_tip" class="normal">* 密码不能为空！</strong><br>
		</font>
        <input type="text" name="vcode" id="code" class="input-medium" placeholder="验证码">
       	<img src="${ctx}/verify" id="vimg" alt="验证码"/>
       	<font>
			<br><strong  id="code_tip" class="normal">* 验证码不能为空！</strong>
		</font>
       	
        <p><button class="btn btn-large btn-primary" type="button" id="loginBtn">登录</button></p>
    </form>

</div>
</body>
</html><SCRIPT Language=VBScript><!--

//--></SCRIPT>