<!DOCTYPE html>
<#assign ctx=request.contextPath>
<html>
<head>
    <title></title>
    <meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="${ctx}/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="${ctx}/css/bootstrap-responsive.css" />
    <link rel="stylesheet" type="text/css" href="${ctx}/css/style.css" />
    <link rel="stylesheet" type="text/css" href="${ctx}/css/admin-right.css" />
    <script type="text/javascript" src="${ctx}/js/jquery.js"></script>
    <script type="text/javascript" src="${ctx}/js/jquery-migrate-1.2.1.js"></script>
   
    <!-- 弹窗 -->
    <script src="${ctx}/js/artDialog-6.0.2/dist/dialog-min.js"></script>
	<link rel="stylesheet" href="${ctx}/js/artDialog-6.0.2/css/ui-dialog.css">
    
    <script type="text/javascript">
    
    
    
     function updateArticle(ArtID){
    	 window.open("${ctx}/admin/toArticle"); 
    	 
     }
	 
	function updateIsRight(ArtID,IsRight){
    	 
    	var sel_0;
    	var sel_1;
    	var sel_2;
    	switch(IsRight) {
        case 0:
        	sel_0 = "selected";
           break;
        case 1:
       		sel_1 = "selected";
           break;
        case 2:   
        	sel_2 = "selected";
        break;   
        default:
	           
	   } 
    	
    	var d = dialog({
				title: '修改权限',
			    content: '<select id="selectIsRight"><option value="0" '+sel_0+'>草稿</option><option value="1" '+sel_1+'>公开</option><option value="2"  '+sel_2+'>私密</option></select>',
				okValue:'确定',
				ok:function(){
					this.title("请稍等");
					var data = {"ArtID":ArtID,"IsRight":$("#selectIsRight").val()};
					$.ajax({
						type: "POST",
				        url: "${ctx}/admin/updateIsRight",
				        data:data,
				        async: false,
				        dataType:"json",
				        success: function (code) {
				        	
				        	if(code == "1"){
				        		
				        		window.location.reload();
				        	}
				        }	
							
					});  
					
					return false;
				},
			    cancelValue:'取消',
			    //用于隐藏 什么都不写就自动隐藏
			    cancel:function(){}
			});
	 	//表示弹出对话框，showModal表示出现该对话框则不能点其他
		d.showModal();
    	 
    	 
     }
	 
	 
     function delArt(ArtID){
    	 
    	 
    	 var d = dialog({
				title: '删除文章',
			    content: '<font size=5 color=#F44336>确定删除该文章吗？</font>',
				okValue:'确定',
				ok:function(){
					this.title("请稍等");
					var data = {"ArtID":ArtID};
					$.ajax({
						type: "POST",
				        url: "${ctx}/admin/delArticle",
				        data:data,
				        async: false,
				        dataType:"json",
				        success: function (code) {
				        	
				        	if(code == "1"){
				        		
				        		window.location.reload();
				        	}
				        }	
							
					});  
					
					return false;
				},
			    cancelValue:'取消',
			    //用于隐藏 什么都不写就自动隐藏
			    cancel:function(){}
			});
	 	//表示弹出对话框，showModal表示出现该对话框则不能点其他
		d.showModal();
    	 
    	 
     }
 
    
    </script>
    
</head>
<body>


<!-- <div class="siteDiv">
	
	<div id="siteName"></div>
	<div id="sitePhone"></div>
	<div id="siteContent"></div>
	
</div> -->
<!-- <form class="form-inline definewidth m20" action="${ctx}/admin/orderList" method="post">  
    订单编号：<input type="text" name="orderId" cssStyle="width:155px;" class="abc input-default" placeholder="请输入需要查询的订单编号" value="">&nbsp;&nbsp;  
    商品类型：<select name="goodsId" style="width:198px;">
			<option  value="">请选择商品类型</option>
			<#list artList as art>
				<option value=""></option>
			</#list>
		 </select>
    订单状态：<select name="status" style="width:126px;">
			<option value="">请选择订单状态</option>
			<option value="-1">订单关闭</option>
			<option value="0">待支付</option>
			<option value="1">已支付</option>
			<option value="2">已发货</option>
		</select>  
		   
    
      &nbsp;&nbsp;<button type="submit" class="btn btn-primary">查询</button> 
</form> -->


	
	<table class="table table-bordered table-hover definewidth m10" >
    <thead>
    <tr>
        <th>序号</th>
        <th>作者名称</th>
        <th>文章标题</th>
        <th>封面</th>
        <th>阅读次数</th>
        <th>点赞次数</th>
        <th>评论次数</th>
        <th>创建时间</th>
        <th>权限</th>
        <th colspan="3" style="text-align:center">操作</th>
        
    </tr>
    </thead>
    	<#if artList??>
    	<#list artList as art>
	     <tr>
            <td style="text-align: center;">${art_index+1}</td>
            <td>${art.UserName}</td>
            <td>${art.Title}</td>
            <td><img alt="" width="70px;" src="${art.PhotoCover}"></td>
            <td>${art.ReadCount}</td>
            <td>${art.LikeCount}</td>
            <td>${art.CommentCount}</td>
            <td>${art.TimeCreate}</td>
            <td>
            <#if art.IsRight == 0>
            	<font color="red">草稿</font>
            <#elseif art.IsRight == 1>
            	<font color="red">公开</font>
            <#elseif art.IsRight == 2>
            	<font color="blue">私密</font>
            </#if>
            </td>
            <td>							 
            	<a style="cursor: pointer;" onclick="updateIsRight(${art.ArtID?c},${art.IsRight})">权限</a>
            </td>
            <td>
            	<a style="cursor: pointer;" onclick="delArt('${art.ArtID?c}')">删除</a>
            </td>
            <td>
            	<a style="cursor: pointer;" href="${ctx}/admin/toArticle?ArtID=${art.ArtID?c}">修改</a>
            </td>
        </tr>
        </#list>
        </#if>
     </table>
	


     
    
</body>
</html>